<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>mmrobot-server: serialcom.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>serialcom.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;sys/io.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;sys/mman.h&gt;</code><br/>
<code>#include &lt;native/task.h&gt;</code><br/>
<code>#include &lt;native/timer.h&gt;</code><br/>
<code>#include &lt;native/sem.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="serialcom_8h_source.html">serialcom.h</a>&quot;</code><br/>

<p><a href="serialcom_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a92c8e376dc1408e51fe5bdcb01f4649d">SERIALCOM_COMPORTADDRESS_1</a>&nbsp;&nbsp;&nbsp;0x3F8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a7c081adc93cbe0724d26fa211a832ab6">SERIALCOM_COMPORTADDRESS_2</a>&nbsp;&nbsp;&nbsp;0x2F8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a368c1614a29016462a3361298c9637e2">SERIALCOM_COMPORTADDRESS_3</a>&nbsp;&nbsp;&nbsp;0x3E8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a01901c0ca0cfcd424468947557bfee58">SERIALCOM_COMPORTADDRESS_4</a>&nbsp;&nbsp;&nbsp;0x2E8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#ab8562a5ce361317b4d7453a8354a5685">serialcom_delayus</a>(a)&nbsp;&nbsp;&nbsp;rt_task_sleep((RTIME)((a)*1000))</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a480f412a5b77f8ad7966a267b4c26f89">serialcom_close</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a5eb7bbd8dec689b7e1943f71a54ed89b">serialcom_init</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig, int ComPortNumber, unsigned long int ComPortBPS)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a54d13404ad9f206887f345c49c0b4499">serialcom_receivebyte</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig, unsigned char *pData, double MaximaEsperaUS)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#aca6e0ddb69ed96c35f139ff05d5b3a72">serialcom_semsignal</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#ac1deb0bc4fce44117f1d2b3aa0d78a2a">serialcom_semwait</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#ac5dcc32914d203e1a81c377fef948014">serialcom_sendbyte</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig, unsigned char *pData)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a7ad801f3b47f1ee0e0cf90ab78a20983">serialcom_status</a> (<a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a> pSerialPortConfig)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">RT_SEM&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="serialcom_8c.html#a34390a6151353a5966040a92b821516d">pComPortSemaphores</a> [4]</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a92c8e376dc1408e51fe5bdcb01f4649d"></a><!-- doxytag: member="serialcom.c::SERIALCOM_COMPORTADDRESS_1" ref="a92c8e376dc1408e51fe5bdcb01f4649d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SERIALCOM_COMPORTADDRESS_1&nbsp;&nbsp;&nbsp;0x3F8</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Endereco base da porta serial COM1. Uso interno. </p>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00028">28</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7c081adc93cbe0724d26fa211a832ab6"></a><!-- doxytag: member="serialcom.c::SERIALCOM_COMPORTADDRESS_2" ref="a7c081adc93cbe0724d26fa211a832ab6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SERIALCOM_COMPORTADDRESS_2&nbsp;&nbsp;&nbsp;0x2F8</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Endereco base da porta serial COM2. Uso interno. </p>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00031">31</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

</div>
</div>
<a class="anchor" id="a368c1614a29016462a3361298c9637e2"></a><!-- doxytag: member="serialcom.c::SERIALCOM_COMPORTADDRESS_3" ref="a368c1614a29016462a3361298c9637e2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SERIALCOM_COMPORTADDRESS_3&nbsp;&nbsp;&nbsp;0x3E8</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Endereco base da porta serial COM3. Uso interno. </p>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00034">34</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

</div>
</div>
<a class="anchor" id="a01901c0ca0cfcd424468947557bfee58"></a><!-- doxytag: member="serialcom.c::SERIALCOM_COMPORTADDRESS_4" ref="a01901c0ca0cfcd424468947557bfee58" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SERIALCOM_COMPORTADDRESS_4&nbsp;&nbsp;&nbsp;0x2E8</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Endereco base da porta serial COM4. Uso interno. </p>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00037">37</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab8562a5ce361317b4d7453a8354a5685"></a><!-- doxytag: member="serialcom.c::serialcom_delayus" ref="ab8562a5ce361317b4d7453a8354a5685" args="(a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define serialcom_delayus</td>
          <td>(</td>
          <td class="paramtype">a&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;rt_task_sleep((RTIME)((a)*1000))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00044">44</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a480f412a5b77f8ad7966a267b4c26f89"></a><!-- doxytag: member="serialcom.c::serialcom_close" ref="a480f412a5b77f8ad7966a267b4c26f89" args="(PSERIALPORTCONFIG pSerialPortConfig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int serialcom_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00117">117</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00118"></a>00118 {
<a name="l00119"></a>00119         rt_sem_delete(&amp;<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a74ad210af22afadd34ea631fd41bd860">pComPortSemaphores</a>[pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#afdab9b8ca1ed50f3970ac4d7215366e1">ComPortNumber</a>-1]);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <span class="keywordflow">return</span> <a class="code" href="serialcom_8h.html#a5a0fdec1e76957e187bd57ebb437fb99">SERIALCOM_SUCCESS</a>;
<a name="l00122"></a>00122 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5eb7bbd8dec689b7e1943f71a54ed89b"></a><!-- doxytag: member="serialcom.c::serialcom_init" ref="a5eb7bbd8dec689b7e1943f71a54ed89b" args="(PSERIALPORTCONFIG pSerialPortConfig, int ComPortNumber, unsigned long int ComPortBPS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int serialcom_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ComPortNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long int&nbsp;</td>
          <td class="paramname"> <em>ComPortBPS</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Funcao que inicia a porta serial ComPortNumber com a taxa dada em BPS por ComPortBPS. Essa funcao dever ser chamada por cada thread que tenha acesso porta serial ComPortNumber. Seus argumentos de chamada so: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pSerialPortConfig</em>&nbsp;</td><td>Ponteiro para estrutura SERIALPORCONFIG que guarda informaes de configurao da porta serial no contexto do thread de chamada. Mesmo que uma dada porta serial seja utilizada por diversos threads, cada thread dever ter a sua estrutura SERIALPORCONFIG. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ComPortNumber</em>&nbsp;</td><td>Numero da porta serial, no intervalo de 1 a 4. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ComPortBPS</em>&nbsp;</td><td>Taxa de comunicao em BPS, no intervalo de 2 a 115200. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SERIALCOM_SUCCESS : Porta iniciada com sucesso. </dd>
<dd>
SERIALCOM_ERROR_INCORRECTPORTNUMBER : Erro, corresponde a um ComPortNumber invlido. </dd>
<dd>
SERIALCOM_ERROR_MAXBPSPRECISION : Erro, a taxa ComPortBPS no pode ser realizada com erro inferior a. SERIALCOM_MAXBPSPRECISION. </dd>
<dd>
SERIALCOM_ERROR_IOPL : Erro, corresponde a uma tentativa de executar o programa sem que se tenha acesso privilegiado de administrador a portas de E/S. </dd></dl>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00060">60</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00061"></a>00061 {
<a name="l00062"></a>00062         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> BPSClockDivisor;
<a name="l00063"></a>00063         <span class="keywordtype">float</span> BPSPrecision;
<a name="l00064"></a>00064         <span class="keywordtype">char</span> semname[50];
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#afdab9b8ca1ed50f3970ac4d7215366e1">ComPortNumber</a> = ComPortNumber; 
<a name="l00067"></a>00067         <span class="keywordflow">switch</span>(ComPortNumber){
<a name="l00068"></a>00068                 <span class="keywordflow">case</span> 0:
<a name="l00069"></a>00069                         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> = 0x0400; 
<a name="l00070"></a>00070                 <span class="keywordflow">break</span>;
<a name="l00071"></a>00071                 <span class="keywordflow">case</span> 1:
<a name="l00072"></a>00072                         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> = <a class="code" href="serialcom_8c.html#a92c8e376dc1408e51fe5bdcb01f4649d">SERIALCOM_COMPORTADDRESS_1</a>; 
<a name="l00073"></a>00073                 <span class="keywordflow">break</span>;
<a name="l00074"></a>00074                 <span class="keywordflow">case</span> 2:
<a name="l00075"></a>00075                         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> = <a class="code" href="serialcom_8c.html#a7c081adc93cbe0724d26fa211a832ab6">SERIALCOM_COMPORTADDRESS_2</a>; 
<a name="l00076"></a>00076                 <span class="keywordflow">break</span>;
<a name="l00077"></a>00077                 <span class="keywordflow">case</span> 3:
<a name="l00078"></a>00078                         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> = <a class="code" href="serialcom_8c.html#a368c1614a29016462a3361298c9637e2">SERIALCOM_COMPORTADDRESS_3</a>; 
<a name="l00079"></a>00079                 <span class="keywordflow">break</span>;
<a name="l00080"></a>00080                 <span class="keywordflow">case</span> 4:
<a name="l00081"></a>00081                         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> = <a class="code" href="serialcom_8c.html#a01901c0ca0cfcd424468947557bfee58">SERIALCOM_COMPORTADDRESS_4</a>; 
<a name="l00082"></a>00082                 <span class="keywordflow">break</span>;
<a name="l00083"></a>00083                 <span class="keywordflow">default</span>:
<a name="l00084"></a>00084                         <span class="keywordflow">return</span> <a class="code" href="serialcom_8h.html#a72c589a0e28e387b55e20336f2e93021">SERIALCOM_ERROR_INCORRECTPORTNUMBER</a>;
<a name="l00085"></a>00085         }
<a name="l00086"></a>00086         
<a name="l00087"></a>00087         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#afdab9b8ca1ed50f3970ac4d7215366e1">ComPortNumber</a> = ComPortNumber; 
<a name="l00088"></a>00088         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#aa6dea3f4c4292d4be56bbf2d7ac4c196">ComPortBPS</a> = ComPortBPS;
<a name="l00089"></a>00089         pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#ae5c4edc520a9a85a82daada36fb4ea40">FramePeriodUS</a> = (1e7)/(((<span class="keywordtype">float</span>)(ComPortBPS)));
<a name="l00090"></a>00090 
<a name="l00091"></a>00091         BPSClockDivisor = 115200 / ComPortBPS;
<a name="l00092"></a>00092         BPSPrecision = (((double)(ComPortBPS)) - 115200.0/BPSClockDivisor)/((double)(ComPortBPS));
<a name="l00093"></a>00093         <span class="keywordflow">if</span>(fabs(BPSPrecision) &gt; <a class="code" href="serialcom_8h.html#a0eeee6b0469b12865344fb8e1dc7ff54">SERIALCOM_MAXBPSPRECISION</a>){
<a name="l00094"></a>00094                 <span class="keywordflow">return</span> <a class="code" href="serialcom_8h.html#a302cedb96f53be4d397c4307326a4cfa">SERIALCOM_ERROR_MAXBPSPRECISION</a>;
<a name="l00095"></a>00095         }
<a name="l00096"></a>00096 
<a name="l00097"></a>00097         <span class="keywordflow">if</span>(iopl(3)&lt;0){
<a name="l00098"></a>00098                 printf(<span class="stringliteral">&quot;seriallib_iniciar: iopl error&quot;</span>);
<a name="l00099"></a>00099                 <span class="keywordflow">return</span> <a class="code" href="serialcom_8h.html#a264fd1a738f038a013c61212b7ec11d3">SERIALCOM_ERROR_IOPL</a>;
<a name="l00100"></a>00100         }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102         outb(0, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 1);         <span class="comment">// Desativar interrupes </span>
<a name="l00103"></a>00103         outb(0x80, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 3);      <span class="comment">// DLAB ON </span>
<a name="l00104"></a>00104         outb((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)(BPSClockDivisor &amp; 0xFF), pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 0);   <span class="comment">// Baud Rate - DL Byte </span>
<a name="l00105"></a>00105         outb((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)((BPSClockDivisor &gt;&gt; 8) &amp; 0xFF), pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 1);    <span class="comment">// Baud Rate - DH Byte </span>
<a name="l00106"></a>00106         outb(0x03, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 3);      <span class="comment">// 8 Bits, No Parity, 1 Stop Bit </span>
<a name="l00107"></a>00107         <span class="comment">//outb(0x08, pSerialPortConfig-&gt;ComPortAddress + 3);    // 8 Bits, No Parity, 2 Stop Bits </span>
<a name="l00108"></a>00108         outb(0xC7, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 2);      <span class="comment">// FIFO: 14 bytes, limpa TX e RX fifos, habilita</span>
<a name="l00109"></a>00109         outb(0x0B, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 4);      <span class="comment">// Ativa DTR, RTS = 0, e OUT2   </span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         sprintf(semname,<span class="stringliteral">&quot;CoSem%i&quot;</span>,ComPortNumber);
<a name="l00112"></a>00112         rt_sem_create(&amp;<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a74ad210af22afadd34ea631fd41bd860">pComPortSemaphores</a>[ComPortNumber-1],semname,1,S_FIFO);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="keywordflow">return</span> <a class="code" href="serialcom_8h.html#a5a0fdec1e76957e187bd57ebb437fb99">SERIALCOM_SUCCESS</a>;
<a name="l00115"></a>00115 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a54d13404ad9f206887f345c49c0b4499"></a><!-- doxytag: member="serialcom.c::serialcom_receivebyte" ref="a54d13404ad9f206887f345c49c0b4499" args="(PSERIALPORTCONFIG pSerialPortConfig, unsigned char *pData, double MaximaEsperaUS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int serialcom_receivebyte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>pData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>MaximaEsperaUS</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Funcao que aguarda um byte chegar pela porta serial descrita por pSerialPortConfig por um tempo mximo dado por MaximaEsperaUS, dado em microsegundos. Se um dado chegar dentro do perodo dado por MaximaEsperaUS, o mesmo ser colocado na varivel apontada por pData. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pSerialPortConfig</em>&nbsp;</td><td>Ponteiro para estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a> que guarda informaes de configurao da porta serial no contexto do thread de chamada. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pData</em>&nbsp;</td><td>Ponteiro para o byte recebido. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MaximaEsperaUS</em>&nbsp;</td><td>Tempo mximo de espera pela chegada de um byte pela porta. Se MaximaEsperaUS </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SERIALCOM_SUCCESS : Operao realizada com sucesso. Um byte foi recebido pela porta serial e se encontra disponvel na varivel apontada por pData. </dd>
<dd>
SERIALCOM_ERROR_MAXWAITFORRECEPTION : Nenhum bayte chegou dentro do tempo estipulado por MaximaEsperaUS </dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Essa funcao fica bloqueada por at MaximaEsperaUS enquanto um byte no chegar. </dd></dl>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00216">216</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00217"></a>00217 {
<a name="l00218"></a>00218         <span class="keywordtype">double</span>  ElapsedTime;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="keywordflow">if</span>(MaximaEsperaUS&lt;0) MaximaEsperaUS = 0; <span class="comment">// Espera minima de 0 us.</span>
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         ElapsedTime = 0.0;
<a name="l00223"></a>00223         <span class="keywordflow">while</span>(1)
<a name="l00224"></a>00224         {
<a name="l00225"></a>00225                 <span class="keywordflow">if</span>( (<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a7ad801f3b47f1ee0e0cf90ab78a20983">serialcom_status</a>(pSerialPortConfig) &amp; <a class="code" href="serialcom_8h.html#a76de90ac046bfb9000ccd6845f71f25d">SERIALCOM_STATUSMASK_RX_DATA_READY</a>) ){
<a name="l00226"></a>00226 <span class="comment">//                      printf(&quot;\n FILE = %s, LINE = %i&quot;,__FILE__,__LINE__);</span>
<a name="l00227"></a>00227                         *pData = inb(pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 0);
<a name="l00228"></a>00228 <span class="comment">//                      printf(&quot;\n Porta %i, Retornando estado %i&quot;, pSerialPortConfig-&gt;ComPortNumber, SERIALCOM_SUCCESS);</span>
<a name="l00229"></a>00229                         <span class="keywordflow">return</span>(<a class="code" href="serialcom_8h.html#a5a0fdec1e76957e187bd57ebb437fb99">SERIALCOM_SUCCESS</a>);
<a name="l00230"></a>00230                 }
<a name="l00231"></a>00231                 <a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#ab8562a5ce361317b4d7453a8354a5685">serialcom_delayus</a>(0.2*pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#ae5c4edc520a9a85a82daada36fb4ea40">FramePeriodUS</a>);
<a name="l00232"></a>00232                 ElapsedTime += 0.2*pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#ae5c4edc520a9a85a82daada36fb4ea40">FramePeriodUS</a>;
<a name="l00233"></a>00233 <span class="comment">//              printf(&quot;\n ElapsedTime = %f&quot;,ElapsedTime);</span>
<a name="l00234"></a>00234                 <span class="keywordflow">if</span>(ElapsedTime &gt;= MaximaEsperaUS){
<a name="l00235"></a>00235 <span class="comment">//                      printf(&quot;\n FILE = %s, LINE = %i&quot;,__FILE__,__LINE__);</span>
<a name="l00236"></a>00236 <span class="comment">//                      printf(&quot;\n Porta %i, Retornando estado %i&quot;, pSerialPortConfig-&gt;ComPortNumber, SERIALCOM_ERROR_MAXWAITFORRECEPTION);</span>
<a name="l00237"></a>00237                         <span class="keywordflow">return</span>(<a class="code" href="serialcom_8h.html#a7f072f5d8e091db1bfe224b4548d6205">SERIALCOM_ERROR_MAXWAITFORRECEPTION</a>);  <span class="comment">// Dado nao chegou no tempo estipulado.</span>
<a name="l00238"></a>00238                 }
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aca6e0ddb69ed96c35f139ff05d5b3a72"></a><!-- doxytag: member="serialcom.c::serialcom_semsignal" ref="aca6e0ddb69ed96c35f139ff05d5b3a72" args="(PSERIALPORTCONFIG pSerialPortConfig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialcom_semsignal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Funcao que libera semforo que foi previamente cedido por serialcom_semwait para acessar a porta descrita por pSerialPortConfig. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pSerialPortConfig</em>&nbsp;</td><td>Ponteiro para estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a> que guarda informaes de configurao da porta serial no contexto do thread de chamada. Mesmo que uma dada porta serial seja utilizada por diversos threads, cada thread dever ter a sua estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a>.. </td></tr>
  </table>
  </dd>
</dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Se uma determinada porta somente gerenciada por um s thread, no h necessidade de se usar essas funes de semforo. As funes de semforo tm somente utilizade em situaes em que mais de um thread pode acessar a porta serial X, com X = 1, 2, 3 ou 4. </dd>
<dd>
Aps concluir o acesso porta serial cedido por essa funcao, deve-se chamar serialcom_semsignal para liberar o semforo </dd></dl>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00148">148</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00149"></a>00149 {
<a name="l00150"></a>00150         rt_sem_v(&amp;<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a74ad210af22afadd34ea631fd41bd860">pComPortSemaphores</a>[pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#afdab9b8ca1ed50f3970ac4d7215366e1">ComPortNumber</a>-1]);
<a name="l00151"></a>00151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac1deb0bc4fce44117f1d2b3aa0d78a2a"></a><!-- doxytag: member="serialcom.c::serialcom_semwait" ref="ac1deb0bc4fce44117f1d2b3aa0d78a2a" args="(PSERIALPORTCONFIG pSerialPortConfig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialcom_semwait </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Funcao que aguarda semforo para acessar a porta descrita por pSerialPortConfig. Juntamente com serialcom_semsignal, pode-se garantir o acesso exclusivo de um thread porta serial. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pSerialPortConfig</em>&nbsp;</td><td>Ponteiro para estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a> que guarda informaes de configurao da porta serial no contexto do thread de chamada. Mesmo que uma dada porta serial seja utilizada por diversos threads, cada thread dever ter a sua estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a>.. </td></tr>
  </table>
  </dd>
</dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Se uma determinada porta somente gerenciada por um s thread, no h necessidade de se usar essas funes de semforo. As funes de semforo tm somente utilizade em situaes em que mais de um thread pode acessar a porta serial X, com X = 1, 2, 3 ou 4. </dd>
<dd>
Aps concluir o acesso porta serial cedido por essa funcao, deve-se chamar serialcom_semsignal para liberar o semforo </dd></dl>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00134">134</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00135"></a>00135 {
<a name="l00136"></a>00136         rt_sem_p(&amp;<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a74ad210af22afadd34ea631fd41bd860">pComPortSemaphores</a>[pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#afdab9b8ca1ed50f3970ac4d7215366e1">ComPortNumber</a>-1],TM_INFINITE);
<a name="l00137"></a>00137 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac5dcc32914d203e1a81c377fef948014"></a><!-- doxytag: member="serialcom.c::serialcom_sendbyte" ref="ac5dcc32914d203e1a81c377fef948014" args="(PSERIALPORTCONFIG pSerialPortConfig, unsigned char *pData)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int serialcom_sendbyte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>pData</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Funcao que envia um byte apontado por pData pela porta serial descrita por pSerialPortConfig. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pSerialPortConfig</em>&nbsp;</td><td>Ponteiro para estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a> que guarda informaes de configurao da porta serial no contexto do thread de chamada. Mesmo que uma dada porta serial seja utilizada por diversos threads, cada thread dever ter a sua estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a>. Se SERIALCOM_USE_RS485 = 1, ento o sinal RTS ser colocado em nvel lgico 1 enquanto durar o frame do byte enviado, permitindo assim ativar o driver externo de uma porta com conversor RS-485. Nessa situao, essa funcao somente retorna quando o byte tiver sido enviado. Caso contrrio, a funcao somente escrever no buffer de sada o byte apontado por pData, retornando em * seguida. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pData</em>&nbsp;</td><td>Ponteiro para o byte que ser enviado. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SERIALCOM_SUCCESS : Dado escrito no registro de sada com sucesso. Entretanto, isso significa apenas que uma transmisso est em curso. Para se certificar de que o dado foi efetivamente transmitido, deve-se fazer uso da funcao <a class="el" href="serialcom-sb16c1052pci-xenomai_8c.html#a7ad801f3b47f1ee0e0cf90ab78a20983">serialcom_status()</a> </dd>
<dd>
SERIALCOM_ERROR_MAXWAITENDOFTRANSMISSION : Situao de erro em que a funcao ficou aguardando por um perodo de at 5 frames para disponibilizao do registro de sada da porta </dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>Essa funcao fica bloqueada enquanto o ltimo byte escrito no buffer de sada ainda no tiver sido enviado. </dd></dl>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00165">165</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00166"></a>00166 {
<a name="l00167"></a>00167         <span class="keywordtype">int</span> contador;
<a name="l00168"></a>00168 <span class="preprocessor">        #if SERIALCOM_USE_RS485</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> dado;
<a name="l00170"></a>00170 <span class="preprocessor">        #endif</span>
<a name="l00171"></a>00171 <span class="preprocessor"></span>
<a name="l00172"></a>00172         contador = 0;
<a name="l00173"></a>00173         <span class="keywordflow">while</span>(!(<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a7ad801f3b47f1ee0e0cf90ab78a20983">serialcom_status</a>(pSerialPortConfig) &amp; <a class="code" href="serialcom_8h.html#a3db72161c536946e1df76e9562447d5f">SERIALCOM_STATUSMASK_EMPTY_DH_REGISTERS</a>))
<a name="l00174"></a>00174         {
<a name="l00175"></a>00175                 <a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#ab8562a5ce361317b4d7453a8354a5685">serialcom_delayus</a>(0.5*pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#ae5c4edc520a9a85a82daada36fb4ea40">FramePeriodUS</a>); 
<a name="l00176"></a>00176                 <span class="keywordflow">if</span>(++contador&gt;10) <span class="keywordflow">return</span>(<a class="code" href="serialcom_8h.html#ab9c6f98c58213b3a22c38c1296070f30">SERIALCOM_ERROR_MAXWAITENDOFTRANSMISSION</a>);
<a name="l00177"></a>00177         } <span class="comment">// Espera fim da ultima transmissao</span>
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="preprocessor">        #if SERIALCOM_USE_RS485</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>        dado = inb(pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 4);
<a name="l00181"></a>00181         dado = dado &amp; (~0x02);
<a name="l00182"></a>00182         outb(dado, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 4);  <span class="comment">//setar RTS = 1 mantendo OUT2</span>
<a name="l00183"></a>00183 <span class="preprocessor">        #endif</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>        
<a name="l00185"></a>00185         outb(*pData, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 0); <span class="comment">// Envia.</span>
<a name="l00186"></a>00186         
<a name="l00187"></a>00187 <span class="preprocessor">        #if SERIALCOM_USE_RS485</span>
<a name="l00188"></a>00188 <span class="preprocessor"></span><span class="comment">//      serialcom_delayus(pSerialPortConfig-&gt;FramePeriodUS); // Espera o periodo de uma transmisso</span>
<a name="l00189"></a>00189         contador = 0;
<a name="l00190"></a>00190         <span class="keywordflow">while</span>(!(<a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#a7ad801f3b47f1ee0e0cf90ab78a20983">serialcom_status</a>(pSerialPortConfig) &amp; SERIALCOM_STATUSMASK_EMPTY_DH_REGISTERS))
<a name="l00191"></a>00191         {
<a name="l00192"></a>00192                 <a class="code" href="serialcom-sb16c1052pci-xenomai_8c.html#ab8562a5ce361317b4d7453a8354a5685">serialcom_delayus</a>(0.5*pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#ae5c4edc520a9a85a82daada36fb4ea40">FramePeriodUS</a>);
<a name="l00193"></a>00193                 <span class="keywordflow">if</span>(++contador&gt;10) <span class="keywordflow">return</span>(<a class="code" href="serialcom_8h.html#ab9c6f98c58213b3a22c38c1296070f30">SERIALCOM_ERROR_MAXWAITENDOFTRANSMISSION</a>);
<a name="l00194"></a>00194         } <span class="comment">// Espera fim da ultima transmissao</span>
<a name="l00195"></a>00195 
<a name="l00196"></a>00196         dado = inb(pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 4);
<a name="l00197"></a>00197         dado = dado | (0x02);
<a name="l00198"></a>00198         outb(dado, pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 4);  <span class="comment">//setar RTS = 0 mantendo OUT2</span>
<a name="l00199"></a>00199 <span class="preprocessor">        #endif</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>
<a name="l00201"></a>00201         <span class="keywordflow">return</span> <a class="code" href="serialcom_8h.html#a5a0fdec1e76957e187bd57ebb437fb99">SERIALCOM_SUCCESS</a>;
<a name="l00202"></a>00202 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ad801f3b47f1ee0e0cf90ab78a20983"></a><!-- doxytag: member="serialcom.c::serialcom_status" ref="a7ad801f3b47f1ee0e0cf90ab78a20983" args="(PSERIALPORTCONFIG pSerialPortConfig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int serialcom_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSERIALPORTCONFIG.html">PSERIALPORTCONFIG</a>&nbsp;</td>
          <td class="paramname"> <em>pSerialPortConfig</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Funcao que l o registro de status da porta serial descrita por pSerialPortConfig. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pSerialPortConfig</em>&nbsp;</td><td>Ponteiro para estrutura <a class="el" href="structSERIALPORTCONFIG.html">SERIALPORTCONFIG</a> que guarda informaes de configurao da porta serial no contexto do thread de chamada. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>O valor de retorno tem os bits setados conforme que o dado foi efetivamente enviadoos eventos que ocorreram com a porta serial, que podem ser testados usando um teste lgico E bit a bit com as seguintes mscaras: </dd>
<dd>
SERIALCOM_STATUSMASK_ERROR_RX_FIFO </dd>
<dd>
SERIALCOM_STATUSMASK_EMPTY_DH_REGISTERS </dd>
<dd>
SERIALCOM_STATUSMASK_EMPTY_TX_REGISTER </dd>
<dd>
SERIALCOM_STATUSMASK_BREAK_INTERRUPT </dd>
<dd>
SERIALCOM_STATUSMASK_FRAMING_ERROR </dd>
<dd>
SERIALCOM_STATUSMASK_PARITY_ERROR </dd>
<dd>
SERIALCOM_STATUSMASK_OVERRUN_ERROR </dd>
<dd>
SERIALCOM_STATUSMASK_RX_DATA_READY </dd>
<dd>
As mscaras acima correspondem a eventos que so detalhados em <a href="http://www.beyondlogic.org/serial/serial.htm">http://www.beyondlogic.org/serial/serial.htm</a> </dd></dl>

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00258">258</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00259"></a>00259 {
<a name="l00260"></a>00260         <span class="keywordflow">return</span> inb(pSerialPortConfig-&gt;<a class="code" href="structSERIALPORTCONFIG.html#a60c95986733fae1a71ab89bd97ebfed4">ComPortAddress</a> + 5);
<a name="l00261"></a>00261 }
</pre></div></p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a34390a6151353a5966040a92b821516d"></a><!-- doxytag: member="serialcom.c::pComPortSemaphores" ref="a34390a6151353a5966040a92b821516d" args="[4]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RT_SEM <a class="el" href="serialcom_8c.html#a34390a6151353a5966040a92b821516d">pComPortSemaphores</a>[4]</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="serialcom_8c_source.html#l00041">41</a> of file <a class="el" href="serialcom_8c_source.html">serialcom.c</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Fri Jan 14 10:33:52 2011 for mmrobot-server by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
